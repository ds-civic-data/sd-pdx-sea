---
title: "WhitePaper"
output: github_document
---

```{r 0, echo = FALSE, warning = FALSE}
library(tidyverse)
library(riverplot)
library(knitr)
```

# Abstract


Portland, as countless articles will tell you, has been in the past decade experiencing large amounts of population growth. Migration to and from portland is bound to have economic and cultural effects on the city and its residents. Aditionally, it is worth wondering where people are migrating from and what their characteristics are. Our paper is essentially broken down into three components that relate to residential change in Portland. First, we describe migration, with a focus on migration from the Bay Area and Puget Sound/Seattle Area. Second we dicuss economic disparity in the Portland area, and what factors may play a role in that disparity. Third, we dicuss housing prices and changes in housing prices over the last decade in Portland. It seems that there is a high likelihood that these three components are related. We will attempt to show how they may be related. 


# Migration Over Time
This project has focused primarily on the storyline of the migration of people from the Bay Area and Seattle to Portland. We have found, using IRS data, that the largest sources of migration across time to Portland com from these areas as well as the states of California and Washington. Our data tells us about county to county migration. We can observe the largest contributors over time by viewing the Sankey plot shown below.

```{r 1.1, warning = FALSE, out.width='100%'}
setwd("~/sd-pdx-sea/White_paper_docs")
knitr::include_graphics("SankeyFinalFinal.pdf")

```
```{r 1.3, echo = FALSE, warning = FALSE}
dataplot1<- migration3%>%
  filter( destinations == "pdx")%>%
  filter(origin=="bay_area"| origin=="puget_sound_area"|origin == "LA"|origin== "CA"| origin=="WA"|origin=="AZ")
```

```{r 1.4}
ggplot(dataplot1, aes(x = year, y = n, color = origin))+
  geom_line()+
  theme_classic()+
  labs(title = "Migration into Portland Metro Area 2008 to 2016",x = "Year", y = "Number of People", color = "Origin")

```
As we can see from the two plots above migration to Portland from these top areas seems to have been increasing in the last ten years. Aditionally, the Bay Area and Puget sound areas are large contributors to migrations. Aditionally, our findings support the idea that many people are also moving from the Las Angeles Area to the Portland area.

# Economic Disparity
When looking at economic disparity we observed a few different components of resident life that play a factor. We first looked at the different industries of jobs in the Portland area, Bay Area and Puget Sound Area via visualizations. Next, we observed a simplified visualization of classes of occupations based on categorizing jobs into either "White Collar" jobs or "Blue Collar" jobs. 

```{r 2.1, echo = FALSE, warning = FALSE}
setwd("~/sd-pdx-sea/White_paper_docs")
source("occupations_whitepaper.R")
```

```{r 2.1 s/b plots, warning = FALSE}
pdx_sector
sf_sector
sea_sector
```

The plots above, which show Portland, Bay Area and Puget Sound sector distribution, could potentially hint at who is working as what in each of these areas. This visualization shows slight growth in tech accross all areas, but with the least in portland. We also see serious decreases in the business sector and increases in the service sector around 2010, potentially as a result of the 2008 economic crash. Also, there is a steady decrease in all three areas of government workers between 2008 and 2010. 

Many people dicuss the growth of tech in areas like the Bay Area and Portland. Often this growth is blamed for rising living costs such as rent or housing prices. While this may be true, for the greater Portland Metro area, Bay Area and Puget Sound, according to this ACS data it doesnt look like the growth has been too explosive. However, this may be different if we observe the individual counties of these areas instead. One might suspect that whiel San Francisco proper has had a tech boom perhaps its neighboring counties have not. Or, pehaps they have additionally seen tech growth as a result of spillover.

```{r 2.1.2, warning = FALSE}
pdx_sector_county
sf_sector_county
sea_sector_county
```
When we break this occupation data down into areas it is easier to see that potentially changes in different sectors vary across county. For instance in Portland, we can see that by comparison to Clackamas, Multnomah and Washington counties have both seen relatively large growth in the tech sector. 

Next, we will look at trends of classes of residents rather than occupations. This means sorting people into "White Collar" and "Blue Collar" groups. In theory this helps to see larger trends of what types of groups of workers are working in each of these larger areas, and their respective counties.

```{r 2.2.1, warning=FALSE}
pdx_class
sf_class
sea_class
```

These visual elluminate the importance of the 2008 depression, as we see that in all three areas overall there seem to have been decreases in proportion of people working in white collar jobs and increases in proportion of people working in blue collar jobs. Now to further our understanding, here are these classes by county and area.
```{r 2.2.2, warning=FALSE}
pdx_class_county
sf_class_county
sea_class_county
```

One striking difference in the effect of 2008 in Clackamas county. In this areas where there area majority blue collar workers, both classes of workers decreases in 2008, rather than blue collar workers increasing in their proportion. Another notable phenomena may be the seemingly smaller effects on the Bay Area in general.

Next, to dicuss a more macroeconomic component of economic disparity we will look at gini coefficients in the portland area over time. Gini coefficients are a measurement of economic ditribution. In this case they are a measurement of wage ditribution. The gini coefficient is a value between one and zero. For this coefficient zero represents a perfect distribution of wealth, everyone has the same income and one represents perfect inequality, where one person makes all income. The average gini coefficient to urban areas in the United States tends to be around .45.

```{r 2.3, echo = FALSE, Warning = FALSE}
ACS_gini <- read_csv("~/sd-pdx-sea/Raw Data/ACS_gini.csv")
```

```{r 2.3.2, warning = FALSE}
ggplot(ACS_gini, aes(x = year, y = gini, color = county))+
  geom_line(alpha = .5)+
  geom_smooth(se = FALSE, span = 1) +
  labs(x = "Year",
       y = "Gini Coefficient",
       colour = "County",
       title = "Portland Gini Coefficient by County 2008 to 2016")+
  scale_color_manual(values = c("dodgerblue2", "hotpink3", "darkorange3"))
```

The graph above shows gini coefficiency over time where the thinner lines are the actual values and the thicker line show a general trend of the Gini coefficients. As we can see generally gini coefficients have been rising in the portland area over time. Aditionally, Multnomah tends to have a much larger coefficient accross time. 
# Housing Prices


#Modelling the relationships
Finally to attempt to connect the three components we have discussed, we will try modelling two different dependent variables. First, we will model gini coefficienct of the different neighborhoods of Portland and then housing prices, both median and average.


When modelling the genie coefficient we are attempting to see if there is a  correlation between migration or ditribution of jobs with the genie coefficient. We found that 